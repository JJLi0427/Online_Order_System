# Online Order System

## Project Structure
The project follows a typical Maven project structure:
```bash
.
├─src
│  └─main
│      ├─java
│      │  └─com
│      │      └─ljj
│      │          ├─controller
│      │          ├─mapper
│      │          ├─pojo
│      │          └─service
│      │              └─impl
│      ├─resources
│      │  └─com
│      │      └─ljj
│      │          └─mapper
│      └─webapp
│          └─WEB-INF
│              └─jsp
└─pom.xml
```

* `src/main/java`: This is where the Java source files reside.  
* `src/main/resources`: This directory contains resources such as XML and properties files.  
* `src/main/webapp`: This directory contains web application resources.  
* `target`: This directory is generated by Maven and contains the compiled classes and packaged application.  

## Key Configuration Files
* `pom.xml`: This is the project's Maven configuration file. It includes the project dependencies, plugins, and build settings.  
* `applicationContext.xml`: This file contains Spring's application context configuration.  
* `database.properties`: This file contains the database connection properties.  
* `logback.xml`: This file contains the configuration for Logback, the logging framework used in the project.  
* `mybatis-config.xml`: This file contains the configuration for MyBatis, the persistence framework used in the project.  
* `springmvc-config.xml`: This file contains the configuration for Spring MVC, the web framework used in the project.  

## Frameworks Used
The project uses the following key frameworks:

* Spring: Provides the foundational support for developing Java applications.
* Spring MVC: Used for building web applications.
* MyBatis: Used for persistence and database operations.
Logback: Used for logging application events.

## Database Tbales
```sql
CREATE TABLE `Menu` (
  `dish_id` int(6) unsigned zerofill NOT NULL AUTO_INCREMENT,
  `dish_name` varchar(255) NOT NULL,
  `price` decimal(10,2) NOT NULL,
  PRIMARY KEY (`dish_id`) USING HASH,
  UNIQUE KEY `dish_name` (`dish_name`) USING HASH
);
CREATE TABLE `User` (
  `user_id` int(8) unsigned zerofill NOT NULL AUTO_INCREMENT,
  `phone` bigint(11) NOT NULL,
  `table` int(2) DEFAULT NULL,
  `people` int(2) DEFAULT NULL,
  PRIMARY KEY (`user_id`) USING HASH,
  KEY `phone` (`phone`) USING HASH
);
CREATE TABLE `Orders` (
  `order_id` bigint(12) unsigned zerofill NOT NULL AUTO_INCREMENT,
  `prefer` varchar(255) DEFAULT NULL,
  `time` datetime NOT NULL,
  `dish_list` text NOT NULL,
  `user_id` int(8) unsigned NOT NULL,
  `complete` tinyint(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`order_id`) USING HASH,
  CONSTRAINT `Orders_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `User` (`user_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE `Staff` (
  `staff_id` int(6) unsigned zerofill NOT NULL AUTO_INCREMENT,
  `staff_name` varchar(255) NOT NULL,
  `order_id` bigint(12) unsigned DEFAULT NULL,
  `password` varchar(255) NOT NULL,
  PRIMARY KEY (`staff_id`) USING HASH,
  UNIQUE KEY `order_id` (`order_id`) USING HASH,
  CONSTRAINT `Staff_ibfk_1` FOREIGN KEY (`order_id`) REFERENCES `Orders` (`order_id`) ON DELETE NO ACTION ON UPDATE NO ACTION
);
```

## Build and Package
To compile and package the project, use the following Maven command:
```bash
mvn clean package
```
This will create a WAR file in the target directory.

## Deployment
To deploy the application on Tomcat:

1. Copy the generated WAR file from the target directory to the webapps directory of your Tomcat installation.
2. Start Tomcat by running the startup.sh (or startup.bat on Windows) script in the bin directory of your Tomcat installation.
3. The application should now be accessible at http://localhost:8080/ordersystem, assuming Tomcat is running on localhost and port 8080.
Please adjust the URL according to your Tomcat configuration.

## WEB Proxy
Proxy projects through Apache: 
Install Apache in your web server and write a proxy file like this sample
```xml
# file name is your server domain or ip
<VirtualHost *:80>
        ServerName yourdomain.com/IP
        ProxyRequests Off
        ProxyMaxForwards 100
        ProxyPreserveHost On
        ProxyPass / projectdomain.com/IP:8080/
        ProxyPassReverse / projectdomain.com/IP:8080/
 
        <Proxy *>
                Order Deny,Allow
                Allow from all
        </Proxy>
</VirtualHost>
```

## TODO
- [ ] Add staff change password function
- [ ] User order page can see history order
